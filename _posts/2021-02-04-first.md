---
layout: post
title: ë”¥ëŸ¬ë‹ ë…¼ë¬¸ êµ¬í˜„ ê´€ë ¨ ê¸°ì´ˆ ì½”ë”© ì§€ì‹ ì •ë¦¬ 1
subtitle: í…ì„œí”Œë¡œìš°,ì¼€ë¼ìŠ¤,ë…¼ë¬¸ êµ¬í˜„ HowTo
tags: [tensorflow,keras,numpy,pandas]
comment: True
---

## ë”¥ëŸ¬ë‹ ë…¼ë¬¸ êµ¬í˜„ ê´€ë ¨ ê¸°ì´ˆ ì½”ë”© ì§€ì‹ ì •ë¦¬ 1

### í”„ë ˆì„ì›Œí¬ëŠ” í…ì„œí”Œë¡œìš°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤. ì œê°€ ê°•ì˜ë¥¼ ë“£ê³  í•„ìš”í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³¸ ê²ƒì…ë‹ˆë‹¤. ğŸ‘©â€ğŸ’»

#### ë°ì´í„° ë¡œë“œ 

ê¸°ì¡´ì˜ ì¸ë±ìŠ¤ëŠ” ì²«ë²ˆì§¸ ì—´ë¡œ ìë™ìœ¼ë¡œ ì‚½ì…. ì´ ë•Œ *drop=True* ì˜µì…˜ì„ ì£¼ë©´ ê¸°ì¡´ ì¸ë±ìŠ¤ë¥¼ ë²„ë¦¬ê³  ì¬ë°°ì—´ , *frac* ë°˜í™˜í•´ì•¼í•˜ëŠ” ì „ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ë¹„ìœ¨

```python
df=df.sample(frac=1).reset_index(drop=True)
```

#### **ë°ì´í„° íŠ¹ì„± í‘œì¤€í™”í•˜ê¸°** 

â›³ï¸ íŠ¹ì„±ì˜ í‰ê· ì´ 0, í‘œì¤€í¸ì°¨ê°€ 1ì´ ë˜ë„ë¡ ë°˜í™˜ = 'í‘œì¤€í™”'

*fit_transform* : ê° features ì˜ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¥¼ ê³„ì‚°í•œ í›„, ê·¸ì— ë§ê²Œ í‘œì¤€í™”

*transform* : ì‚¬ì „ì— fit_transform ì„ í†µí•´ì„œ êµ¬í•´ì§„ ëª¨ìˆ˜ì— ë§ê²Œ í‘œì¤€í™”, ì„±ëŠ¥ í‰ê°€ëŠ” test ë°ì´í„° í‘œì¤€í™” ì‘ì—… ì‹œì— train ë°ì´í„°(ì˜ ì´í•´í•œ ë°ì´í„°)ë¡œ í•™ìŠµëœ ëª¨ë¸ì´ test ë°ì´í„°(ìƒˆë¡œìš´ ë°ì´í„°)ì— ì–¼ë§ˆë§Œí¼ì˜ ì„±ëŠ¥ì„ ë³´ì´ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©

```python
from sklearn import preprocessing
scaler=preprocessing.StandardScaler()
standardized=scaler.fit_transform(x)
```

ì˜ í‘œì¤€í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸ë„ ê°€ëŠ¥í•˜ë‹¤ :)

```python
print(standardized.std())
```

#### ë°ì´í„° ë¶„í• 

features ë°ì´í„°ì™€ ë¼ë²¨ê°’ì„ ëª¨ë‘ ë„£ì–´ì¤€ ê²½ìš° ì´ ë„¤ ê°€ì§€ ë¶„í• ëœ ê°’ ë°˜í™˜ (x_train, x_test, y_train, y_test)

```python
from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)
```

#### ì„¤ê³„í•œ ëª¨ë¸ êµ¬ì„± ì²´í¬í•˜ê¸° 

```python
from tensorflow.keras.utils import plot_model
plot_model(model)
```

![ìŠ¤í¬ë¦°ìƒ· 2021-02-04 ì˜¤í›„ 12 31 28](https://user-images.githubusercontent.com/67775336/106841173-f68dd900-66e4-11eb-86a4-39ebd2815cd6.png)

#### output ì´ 2ê°œì¼ ì‹œì—ëŠ” ê°ê°ì˜ loss ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ì§€ì •

model.compile(optimizer=optimizer,**loss={'y1_output':'mse','y2_output':'mse'}**)



#### matplotlib ë¡œ ëª¨ë¸ ì„±ëŠ¥ ì‹œê°í™”í•˜ê¸° + ì•½ê°„ì˜ numpy

plt.plot('x','y',data=data_dict)

plt.xlim([xmin,xmax])

plt.ylim([ymin,ymax])

plt.axis([xmin,xmax,ymin,ymax])

plt.scatter(x,y) => sns scatterplot ìœ¼ë¡œë„ ê°€ëŠ¥ !

plt.xticks([0,1,2]), plt.yticks(np.arange(1,6)) ëˆˆê¸ˆ í‘œì‹œ 

ë§Œì•½ ë””í…Œì¼í•˜ê²Œ ì¡°ì •í•˜ê³  ì‹¶ìœ¼ë©´ rcíŒŒë¼ë¯¸í„° ë”•ì…”ë„ˆë¦¬ ê°’ ë³€ê²½í•´ì£¼ê¸° (rc='run command') ex. plt.rcParams['font.size']=12

np.swapaxes(arr,axis1,aixs2) ; ë°°ì—´ì˜ ë‘ ì¶•ì„ ìƒí˜¸êµí™˜í•´ì¤€ë‹¤. 



#### Custom Loss ì‚¬ìš©í•˜ê¸° 

**custom loss ì •ì˜ì— ìœ ìš©í•œ í…ì„œí”Œë¡œìš° ë¬¸ë²•** 

```python
tf.where(is_small_error,small_error_loss,big_error_loss)
#ê±¸ì–´ì¤€ is_small_error ì¡°ê±´ì— True ë©´ small_error_loss ë°˜í™˜, false ë©´ big_error_loss ë°˜í™˜
#hubber loss êµ¬í˜„í•  ë•Œ ìœ ìš©
```

model.compile(**loss=my_hubber_loss**,optimizer=optimizer)

ì´ëŸ° ì‹ìœ¼ë¡œ custom loss ì‚¬ìš© ê°€ëŠ¥ 



#### í…ì„œí”Œë¡œìš° functional api ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

ë§¤ìš° ìœ ì—°í•˜ê¸° ë•Œë¬¸ì— ì‹œì•„ë¯¸ìŠ¤ ë„¤íŠ¸ì›Œí¬ ë“±ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. 

```python
input_a = Input(shape=(28,28,), name="left_input")
vect_output_a = base_network(input_a)
```

ì´ëŸ° ì‹ìœ¼ë¡œ ë¯¸ë¦¬ ì •í•´ì¤€ ëª¨ë¸ì— ìƒˆë¡œ ì •í•´ì¤€ ëª¨ë¸ ë ˆì´ì–´ë¥¼ ë„£ì–´ì¤„ ìˆ˜ ìˆê¸° ë•Œë¬¸ !



#### lambda ë ˆì´ì–´ ì‚¬ìš© (custom layer1)

**ëŒë‹¤ë ˆì´ì–´ ì‚¬ìš© ì‹œ weights ë¥¼ ì •ì˜í•´ì£¼ì§€ëŠ” ì•ŠëŠ”ë‹¤. ê³ ë¡œ, ë‹¨ìˆœí•œ custom í™œì„±í™” í•¨ìˆ˜ ë“±ì„ ì ìš©í•´ì•¼í•  ë•Œ ëŒë‹¤ ë ˆì´ì–´ë¥¼ ì‚¬ìš©í•œë‹¤.** 

model = tf.keras.models.Sequential([

â€‹    tf.keras.layers.Flatten(input_shape=(28, 28)),

â€‹    tf.keras.layers.Dense(128),

â€‹    **tf.keras.layers.Lambda(my_relu)**, 

â€‹    tf.keras.layers.Dense(10, activation='softmax')

])

ì´ëŸ° ì‹ìœ¼ë¡œ ë¯¸ë¦¬ ì •ì˜í•œ í•¨ìˆ˜ë¥¼ layer ë¡œ ì‚¬ìš© ê°€ëŠ¥ ! 



**Custom class ë ˆì´ì–´ ì‚¬ìš© (custom layer2)**

__init__  : ì¼€ë¼ìŠ¤ layer ì„ ìƒì†ë°›ê³  ê¸°ë³¸ ì†ì„±ì„ ì •ì˜í•˜ëŠ” ê³³

**build** : í›ˆë ¨ ê°€ëŠ¥í•œ weights ì„ ì •ì˜í•˜ëŠ” ê³³. shape ë„ ì—¬ê¸°ì„œ ì¡ì•„ì¤„ ìˆ˜ê°€ ìˆë‹¤. 

**call** : custom ì•Œê³ ë¦¬ì¦˜ì„ ì •ì˜í•˜ëŠ” ê³³  

